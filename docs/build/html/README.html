<!DOCTYPE html>
<html class="writer-html5" lang="python" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DynaMapp &mdash; DynaMapp 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=40be6288"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial" href="TUTORIAL.html" />
    <link rel="prev" title="DynaMapp documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            DynaMapp
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">DynaMapp</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#table-of-contents">Table of Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#about">🚀 About</a></li>
<li class="toctree-l2"><a class="reference internal" href="#installation">📝 Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples">💻 Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-1-creating-a-model-instance">Example 1: Creating a Model Instance</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-2-computing-the-generalized-torques-and-inertia-matrix">Example 2: Computing the Generalized Torques and Inertia Matrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-3-computing-state-matrices-a-b-c-d">Example 3: Computing State Matrices (A, B, C, D)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-2-advanced-analysis-stability-controllability-and-observability">Example 2: Advanced Analysis — Stability, Controllability, and Observability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-3-advanced-analysis-stability-controllability-and-observability">Example 3: Advanced Analysis — Stability, Controllability, and Observability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-4-torques-derivatives-with-respect-to-inertia">Example 4: Torques Derivatives with Respect to Inertia</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-5-torques-derivatives-with-respect-to-dh-parameters">Example 5: Torques Derivatives with Respect to DH Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-6-torques-derivatives-with-respect-to-damping">Example 6: Torques Derivatives with Respect to Damping</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#documentation">📚 Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#releases">📦 Releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="#contributing">🤝 Contributing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#license">📃 License</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="TUTORIAL.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="INSTALL.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="REFERENCES.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Packages documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="dynamapp.html">dynamapp</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DynaMapp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">DynaMapp</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/README.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <!-- omit in toc -->
<section class="tex2jax_ignore mathjax_ignore" id="dynamapp">
<h1>DynaMapp<a class="headerlink" href="#dynamapp" title="Link to this heading"></a></h1>
<p><a class="reference external" href="https://github.com/wissem01chiha/dynamapp/actions/workflows/tests.yml"><img alt="Tests" src="https://github.com/wissem01chiha/dynamapp/actions/workflows/tests.yml/badge.svg" /></a>
<a class="reference external" href="https://github.com/wissem01chiha/dynamapp/actions/workflows/pylint.yml"><img alt="PyLint" src="https://github.com/wissem01chiha/dynamapp/actions/workflows/pylint.yml/badge.svg" /></a>
<a class="reference external" href="https://github.com/wissem01chiha/dynamapp/actions/workflows/build-docs.yml"><img alt="build-docs" src="https://github.com/wissem01chiha/dynamapp/actions/workflows/build-docs.yml/badge.svg" /></a>
<img alt="GitHub License" src="https://img.shields.io/github/license/wissem01chiha/dynamapp" />
<img alt="GitHub last commit" src="https://img.shields.io/github/last-commit/wissem01chiha/dynamapp" />
<img alt="GitHub commit activity (branch)" src="https://img.shields.io/github/commit-activity/t/wissem01chiha/dynamapp/main" /></p>
<p>DynaMapp is a lightweight Python software package designed for the representation and identification of multibody systems. It is optimized for efficient computation and visualization of how static input parameters (such as inertial, geometric, and electromechanical) affect the behavior of these systems.</p>
<!-- omit in toc -->
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="#-about"><span class="xref myst">🚀 About</span></a></p></li>
<li><p><a class="reference internal" href="#-installation"><span class="xref myst">📝 Installation</span></a></p></li>
<li><p><a class="reference internal" href="#-examples"><span class="xref myst">💻 Examples</span></a></p></li>
<li><p><a class="reference internal" href="#-documentation"><span class="xref myst">📚 Documentation</span></a></p></li>
<li><p><a class="reference internal" href="#-releases"><span class="xref myst">📦 Releases</span></a></p></li>
<li><p><a class="reference internal" href="#-contributing"><span class="xref myst">🤝 Contributing</span></a></p></li>
<li><p><a class="reference internal" href="#-license"><span class="xref myst">📃 License</span></a></p></li>
</ul>
</section>
<section id="about">
<h2>🚀 About<a class="headerlink" href="#about" title="Link to this heading"></a></h2>
<p>The primary goal of <strong>DynaMapp</strong> is to offer an implementation of common rigid body dynamics algorithms and their derivatives using <a class="reference external" href="https://jax.readthedocs.io/en/latest/quickstart.html">JAX</a>.</p>
<p>It provides tools for computing the <a class="reference external" href="https://en.wikipedia.org/wiki/State-space_representation">state-space</a> representation of these systems.</p>
<ul class="simple">
<li><p>Compute the Jacobian tensors of the joint torque vector as a function of the system parameters vector using <a class="reference external" href="https://jax.readthedocs.io/en/latest/automatic-differentiation.html">automatic differentiation</a>.</p></li>
<li><p>Compute the Jacobian of other quantities (such as the global inertia matrix and Coriolis matrix) with respect to the input parameters.</p></li>
<li><p>Implement common identification algorithms for optimizing the multibody system parameters.</p></li>
</ul>
<p>The package does not rely on any rigid body dynamics libraries.</p>
<blockquote>
<div><p><strong>Note</strong>:<br />
This is an early-stage research software, and many  parts still require focus and further implementation.</p>
</div></blockquote>
</section>
<section id="installation">
<h2>📝 Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h2>
<p>See the <a class="reference internal" href="INSTALL.html"><span class="std std-doc">INSTALL</span></a> file.</p>
</section>
<section id="examples">
<h2>💻 Examples<a class="headerlink" href="#examples" title="Link to this heading"></a></h2>
<p>This section provides an overview of examples demonstrating the usage of the package's basic functions and mathematical notations. Currently, the documentation lacks detailed and meaningful examples, and these examples do not cover all software functions.</p>
<p>All guidelines will be available in the <a class="reference external" href="https://wissem01chiha.github.io/dynamapp/TUTORIAL.html">Tutoriel</a>.</p>
<!-- omit in toc -->
<section id="example-1-creating-a-model-instance">
<h3>Example 1: Creating a Model Instance<a class="headerlink" href="#example-1-creating-a-model-instance" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamapp.model</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="c1"># Define the Inertia matrices (list of 6x6 matrices)</span>
<span class="n">Imats</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="c1"># Define the Denavit-Hartenberg parameters (theta, d, a, alpha)</span>
<span class="n">dhparams</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="c1"># Define the gravity vector</span>
<span class="n">gravity</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.81</span>
<span class="c1"># Define damping coefficients</span>
<span class="n">dampings</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="c1"># Create the model instance</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">Imats</span><span class="p">,</span> <span class="n">dhparams</span><span class="p">,</span> <span class="n">gravity</span><span class="p">,</span> <span class="n">dampings</span><span class="p">)</span>
<span class="c1"># Check the generalized torques at initial joint configurations (q, qp, qpp = 0)</span>
<span class="n">torques</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generalized_torques</span><span class="p">()</span>
</pre></div>
</div>
<!-- omit in toc -->
</section>
<section id="example-2-computing-the-generalized-torques-and-inertia-matrix">
<h3>Example 2: Computing the Generalized Torques and Inertia Matrix<a class="headerlink" href="#example-2-computing-the-generalized-torques-and-inertia-matrix" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamapp.model</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="c1"># Define joint positions, velocities, and accelerations</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>  <span class="c1"># Joint positions (rad)</span>
<span class="n">qp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span> <span class="c1"># Joint velocities (rad/s)</span>
<span class="n">qpp</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span> <span class="c1"># Joint accelerations (rad/s^2)</span>
<span class="c1"># Define the Inertia matrices, DH parameters, and damping coefficients</span>
<span class="n">Imats</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
<span class="n">dhparams</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="n">gravity</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.81</span>
<span class="n">dampings</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">]</span>
<span class="c1"># Create the model instance</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">Imats</span><span class="p">,</span> <span class="n">dhparams</span><span class="p">,</span> <span class="n">gravity</span><span class="p">,</span> <span class="n">dampings</span><span class="p">)</span>
<span class="c1"># Compute the Generalized Torques at the current joint configuration</span>
<span class="n">generalized_torques</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">generalized_torques</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">qp</span><span class="p">,</span> <span class="n">qpp</span><span class="p">)</span>
<span class="c1"># Compute the Inertia Matrix at the current joint configuration</span>
<span class="n">inertia_matrix</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">inertia_tensor</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
</pre></div>
</div>
<!-- omit in toc -->
</section>
<section id="example-3-computing-state-matrices-a-b-c-d">
<h3>Example 3: Computing State Matrices (A, B, C, D)<a class="headerlink" href="#example-3-computing-state-matrices-a-b-c-d" title="Link to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{aligned}
    \dot{x} &amp;= \mathcal{A}(x) x + \mathcal{B}(x) u \\
    y &amp;= \mathcal{\hat{C}} x 
\end{aligned}
\end{split}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamapp.model_state</span> <span class="kn">import</span> <span class="n">ModelState</span>
<span class="c1"># Define system parameters (Inertia matrices, DH parameters, etc.)</span>
<span class="n">Imats</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>  <span class="c1"># Example inertia matrices</span>
<span class="n">dhparams</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="c1"># Initialize the ModelState object</span>
<span class="n">model_state</span> <span class="o">=</span> <span class="n">ModelState</span><span class="p">(</span><span class="n">Imats</span><span class="p">,</span> <span class="n">dhparams</span><span class="p">)</span>
<span class="c1"># Define an example state vector (x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">model_state</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndof</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Example state vector (2 * ndof)</span>
<span class="c1"># Compute the state-space matrices</span>
<span class="n">model_state</span><span class="o">.</span><span class="n">_compute_matrices</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Access and print the state-space matrices A, B, C, D</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_state</span><span class="o">.</span><span class="n">model_state_space</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_state</span><span class="o">.</span><span class="n">model_state_space</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_state</span><span class="o">.</span><span class="n">model_state_space</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_state</span><span class="o">.</span><span class="n">model_state_space</span><span class="o">.</span><span class="n">d</span><span class="p">)</span> 
</pre></div>
</div>
<p>The last model computation serves as a bridge to state-space identification techniques, subspace identification methods, and other fields.</p>
<blockquote>
<div><p><strong>Note:</strong>  The stability of the computed matrices is not guaranteed. The intensive computations of derivatives are error-prone, so a new computation method is needed!</p>
</div></blockquote>
<!-- omit in toc -->
</section>
<section id="example-2-advanced-analysis-stability-controllability-and-observability">
<h3>Example 2: Advanced Analysis — Stability, Controllability, and Observability<a class="headerlink" href="#example-2-advanced-analysis-stability-controllability-and-observability" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamapp.model_state</span> <span class="kn">import</span> <span class="n">ModelState</span>
<span class="n">Imats</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>  <span class="c1"># Example inertia matrices</span>
<span class="n">dhparams</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="c1"># Initialize the ModelState object</span>
<span class="n">model_state</span> <span class="o">=</span> <span class="n">ModelState</span><span class="p">(</span><span class="n">Imats</span><span class="p">,</span> <span class="n">dhparams</span><span class="p">)</span>
<span class="c1"># Define an example state vector (x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">model_state</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndof</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Example state vector (2 * ndof)</span>
<span class="c1"># Check if the system is stable</span>
<span class="n">is_stable</span> <span class="o">=</span> <span class="n">model_state</span><span class="o">.</span><span class="n">_is_stable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">model_state</span><span class="o">.</span><span class="n">compute_eigvals</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">controllability_matrix</span> <span class="o">=</span> <span class="n">model_state</span><span class="o">.</span><span class="n">compute_ctlb_matrix</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Compute the observability matrix</span>
<span class="n">observability_matrix</span> <span class="o">=</span> <span class="n">model_state</span><span class="o">.</span><span class="n">compute_obs_matrix</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamapp.model_state</span> <span class="kn">import</span> <span class="n">ModelState</span>
<span class="c1"># Define system parameters (Inertia matrices, DH parameters, etc.)</span>
<span class="n">Imats</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>  <span class="c1"># Example inertia matrices</span>
<span class="n">dhparams</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="c1"># Initialize the ModelState object</span>
<span class="n">model_state</span> <span class="o">=</span> <span class="n">ModelState</span><span class="p">(</span><span class="n">Imats</span><span class="p">,</span> <span class="n">dhparams</span><span class="p">)</span>
<span class="c1"># Define an example state vector (x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">model_state</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndof</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Example state vector (2 * ndof)</span>
<span class="c1"># Compute the state-space matrices</span>
<span class="n">model_state</span><span class="o">.</span><span class="n">_compute_matrices</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Access and print the state-space matrices A, B, C, D</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_state</span><span class="o">.</span><span class="n">model_state_space</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_state</span><span class="o">.</span><span class="n">model_state_space</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_state</span><span class="o">.</span><span class="n">model_state_space</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_state</span><span class="o">.</span><span class="n">model_state_space</span><span class="o">.</span><span class="n">d</span><span class="p">)</span> 
</pre></div>
</div>
<p>The last model computation serves as a bridge to state-space identification techniques, subspace identification methods, and other fields.</p>
<!-- omit in toc -->
</section>
<section id="example-3-advanced-analysis-stability-controllability-and-observability">
<h3>Example 3: Advanced Analysis — Stability, Controllability, and Observability<a class="headerlink" href="#example-3-advanced-analysis-stability-controllability-and-observability" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamapp.model_state</span> <span class="kn">import</span> <span class="n">ModelState</span>
<span class="n">Imats</span> <span class="o">=</span> <span class="p">[</span><span class="n">jnp</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>  <span class="c1"># Example inertia matrices</span>
<span class="n">dhparams</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span>
    <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">jnp</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="c1"># Initialize the ModelState object</span>
<span class="n">model_state</span> <span class="o">=</span> <span class="n">ModelState</span><span class="p">(</span><span class="n">Imats</span><span class="p">,</span> <span class="n">dhparams</span><span class="p">)</span>
<span class="c1"># Define an example state vector (x)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">model_state</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">ndof</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>  <span class="c1"># Example state vector (2 * ndof)</span>
<span class="c1"># Check if the system is stable</span>
<span class="n">is_stable</span> <span class="o">=</span> <span class="n">model_state</span><span class="o">.</span><span class="n">_is_stable</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">eigenvalues</span> <span class="o">=</span> <span class="n">model_state</span><span class="o">.</span><span class="n">compute_eigvals</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">controllability_matrix</span> <span class="o">=</span> <span class="n">model_state</span><span class="o">.</span><span class="n">compute_ctlb_matrix</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="c1"># Compute the observability matrix</span>
<span class="n">observability_matrix</span> <span class="o">=</span> <span class="n">model_state</span><span class="o">.</span><span class="n">compute_obs_matrix</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<!-- omit in toc -->
</section>
<section id="example-4-torques-derivatives-with-respect-to-inertia">
<h3>Example 4: Torques Derivatives with Respect to Inertia<a class="headerlink" href="#example-4-torques-derivatives-with-respect-to-inertia" title="Link to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[J = \frac{\partial \tau}{\partial I}\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">m</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="o">...</span><span class="p">)</span>  <span class="c1"># A Model object</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">])</span>  <span class="c1"># Generalized positions (q)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>  <span class="c1"># Generalized velocities (v)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">])</span>  <span class="c1"># Generalized accelerations (a)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">generalized_torques_wrt_inertia</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<!-- omit in toc -->
</section>
<section id="example-5-torques-derivatives-with-respect-to-dh-parameters">
<h3>Example 5: Torques Derivatives with Respect to DH Parameters<a class="headerlink" href="#example-5-torques-derivatives-with-respect-to-dh-parameters" title="Link to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[J = \frac{\partial \tau}{\partial \theta}
\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example Usage</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">])</span>  <span class="c1"># Generalized positions (q)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>  <span class="c1"># Generalized velocities (v)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">])</span>  <span class="c1"># Generalized accelerations (a)</span>
<span class="c1"># Compute the Jacobian of generalized torques with respect to DH parameters</span>
<span class="n">torques_wrt_dhparams</span> <span class="o">=</span> <span class="n">generalized_torques_wrt_dhparams</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
<!-- omit in toc -->
</section>
<section id="example-6-torques-derivatives-with-respect-to-damping">
<h3>Example 6: Torques Derivatives with Respect to Damping<a class="headerlink" href="#example-6-torques-derivatives-with-respect-to-damping" title="Link to this heading"></a></h3>
<div class="math notranslate nohighlight">
\[J = \frac{\partial \tau}{\partial c}
\]</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">q</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.3</span><span class="p">])</span>  <span class="c1"># Generalized positions (q)</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>  <span class="c1"># Generalized velocities (v)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.15</span><span class="p">])</span>  <span class="c1"># Generalized accelerations (a)</span>
<span class="n">torques_wrt_damping</span> <span class="o">=</span> <span class="n">generalized_torques_wrt_damping</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="documentation">
<h2>📚 Documentation<a class="headerlink" href="#documentation" title="Link to this heading"></a></h2>
<p>The official documentation is avalible at <a class="reference external" href="https://wissem01chiha.github.io/dynamapp/README.html">link</a></p>
</section>
<section id="releases">
<h2>📦 Releases<a class="headerlink" href="#releases" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p><strong><a class="reference external" href="https://github.com/wissem01chiha/dynamapp/tree/main">v1.0.0</a></strong> - Jan 2025, current release</p></li>
<li><p><strong><a class="reference external" href="https://github.com/wissem01chiha/dynamapp/tree/dev">v0.1.0</a></strong> — august 2024: first release.</p></li>
</ul>
</section>
<section id="contributing">
<h2>🤝 Contributing<a class="headerlink" href="#contributing" title="Link to this heading"></a></h2>
<p>please review the following:</p>
<ul class="simple">
<li><p>The <a class="reference internal" href="CHANGELOG.html"><span class="std std-doc">CHANGELOG</span></a> for an overview of updates and changes.</p></li>
<li><p>The <a class="reference internal" href="CONTRIBUTING.html"><span class="std std-doc">CONTRIBUTING</span></a> guide for detailed instructions on how to contribute.</p></li>
</ul>
<p>This is an early-stage research software, and contributions are highly welcomed!</p>
<p>If you have any questions or need assistance, feel free to reach out via <a class="reference external" href="mailto:chihawissem08&#37;&#52;&#48;gmail&#46;com">email</a>.</p>
</section>
<section id="license">
<h2>📃 License<a class="headerlink" href="#license" title="Link to this heading"></a></h2>
<p>See the <a class="reference internal" href="#LICENSE.txt"><span class="xref myst">LICENSE</span></a> file.</p>
<p><a class="reference internal" href="#top"><span class="xref myst">Back to top</span></a></p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="DynaMapp documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="TUTORIAL.html" class="btn btn-neutral float-right" title="Tutorial" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Wissem CHIHA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>