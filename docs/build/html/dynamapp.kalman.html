<!DOCTYPE html>
<html class="writer-html5" lang="python" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>kalman module &mdash; DynaMapp 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=40be6288"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="math_utils module" href="dynamapp.math_utils.html" />
    <link rel="prev" title="dynamapp" href="dynamapp.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            DynaMapp
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="README.html">DynaMapp</a></li>
<li class="toctree-l1"><a class="reference internal" href="TUTORIAL.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="INSTALL.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="REFERENCES.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="CHANGELOG.html">Changelog</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Packages documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="dynamapp.html">dynamapp</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="dynamapp.html#submodules">Submodules</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">kalman module</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#dynamapp.kalman.Kalman"><code class="docutils literal notranslate"><span class="pre">Kalman</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.math_utils.html">math_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.moesp.html">moesp module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.nfoursid.html">nfoursid module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.regressors.html">regressors module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.model.html">model module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.actuators.html">actuators module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.data_utils.html">data_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.solvers.html">solvers module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.reductions.html">reductions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.state_space.html">state_space module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.model_state.html">model_state module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.trajectory.html">trajectory module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.utils.html">utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.viscoelastic.html">viscoelastic module</a></li>
<li class="toctree-l3"><a class="reference internal" href="dynamapp.identification.html">identification module</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="CONTRIBUTING.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="TODO.html">Todo list</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DynaMapp</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="dynamapp.html">dynamapp</a></li>
      <li class="breadcrumb-item active">kalman module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/dynamapp.kalman.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dynamapp.kalman">
<span id="kalman-module"></span><h1>kalman module<a class="headerlink" href="#module-dynamapp.kalman" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dynamapp.kalman.</span></span><span class="sig-name descname"><span class="pre">Kalman</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_space</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="dynamapp.state_space.html#dynamapp.state_space.StateSpace" title="dynamapp.state_space.StateSpace"><span class="pre">StateSpace</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_covariance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamapp/kalman.html#Kalman"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamapp.kalman.Kalman" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation [1] of a Kalman filter for a state-space model <code class="docutils literal notranslate"><span class="pre">state_space</span></code>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{cases}
    x_{k+1} &amp;= A x_k + B u_k + w_k \\
    y_k &amp;= C x_k + D u_k + v_k
\end{cases}\end{split}\]</div>
<p>The matrices <span class="math notranslate nohighlight">\((A, B, C, D)\)</span> are taken from the state-space model <code class="docutils literal notranslate"><span class="pre">state_space</span></code>.
The measurement-noise <span class="math notranslate nohighlight">\(v_k\)</span> and process-noise <span class="math notranslate nohighlight">\(w_k\)</span> have a covariance matrix
<code class="docutils literal notranslate"><span class="pre">noise_covariance</span></code> defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\texttt{noise\_covariance} := \mathbb{E} \bigg (
\begin{bmatrix}
    v \\ w
\end{bmatrix}
\begin{bmatrix}
    v \\ w
\end{bmatrix}^\mathrm{T}
\bigg )\end{split}\]</div>
<p>[1] Verhaegen, Michel, and Vincent Verdult. <em>Filtering and system identification: a least squares approach.</em>
Cambridge university press, 2007.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.output_label">
<span class="sig-name descname"><span class="pre">output_label</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'output'</span></em><a class="headerlink" href="#dynamapp.kalman.Kalman.output_label" title="Link to this definition"></a></dt>
<dd><p>Label given to an output column in <code class="docutils literal notranslate"><span class="pre">self.to_dataframe</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.standard_deviation_label">
<span class="sig-name descname"><span class="pre">standard_deviation_label</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'standard</span> <span class="pre">deviation'</span></em><a class="headerlink" href="#dynamapp.kalman.Kalman.standard_deviation_label" title="Link to this definition"></a></dt>
<dd><p>Label given to a standard deviation column in <code class="docutils literal notranslate"><span class="pre">self.to_dataframe</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.actual_label">
<span class="sig-name descname"><span class="pre">actual_label</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'actual'</span></em><a class="headerlink" href="#dynamapp.kalman.Kalman.actual_label" title="Link to this definition"></a></dt>
<dd><p>Label given to a column in <code class="docutils literal notranslate"><span class="pre">self.to_dataframe</span></code>, indicating measured values.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.filtered_label">
<span class="sig-name descname"><span class="pre">filtered_label</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'filtered'</span></em><a class="headerlink" href="#dynamapp.kalman.Kalman.filtered_label" title="Link to this definition"></a></dt>
<dd><p>Label given to a column in <code class="docutils literal notranslate"><span class="pre">self.to_dataframe</span></code>, indicating the filtered state of the Kalman filter.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.next_predicted_label">
<span class="sig-name descname"><span class="pre">next_predicted_label</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'next</span> <span class="pre">predicted</span> <span class="pre">(no</span> <span class="pre">input)'</span></em><a class="headerlink" href="#dynamapp.kalman.Kalman.next_predicted_label" title="Link to this definition"></a></dt>
<dd><p>Label given to a column in <code class="docutils literal notranslate"><span class="pre">self.to_dataframe</span></code>, indicating the predicted state of the Kalman filter under the
absence of further inputs.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.next_predicted_corrected_label">
<span class="sig-name descname"><span class="pre">next_predicted_corrected_label</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'next</span> <span class="pre">predicted</span> <span class="pre">(input</span> <span class="pre">corrected)'</span></em><a class="headerlink" href="#dynamapp.kalman.Kalman.next_predicted_corrected_label" title="Link to this definition"></a></dt>
<dd><p>Label given to a column in <code class="docutils literal notranslate"><span class="pre">self.to_dataframe</span></code>, indicating the predicted state of the Kalman filter corrected
by previous inputs. The inputs to the state-space model are known, but not at the time that the prediction was
made. In order to make a fair comparison for prediction performance, the direct effect of the input on the output
by the matrix <span class="math notranslate nohighlight">\(D\)</span> is removed in this column.</p>
<p>The latest prediction will have <code class="docutils literal notranslate"><span class="pre">np.nan</span></code> in this column, since the input is not yet known.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">u</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamapp/kalman.html#Kalman.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamapp.kalman.Kalman.step" title="Link to this definition"></a></dt>
<dd><p>Given an observed input <code class="docutils literal notranslate"><span class="pre">u</span></code> and output <code class="docutils literal notranslate"><span class="pre">y</span></code>, update the filtered and predicted states of the Kalman filter.
Follows the implementation of the conventional Kalman filter in [1] on page 140.</p>
<p>The output <code class="docutils literal notranslate"><span class="pre">y</span></code> can be missing by setting <code class="docutils literal notranslate"><span class="pre">y=None</span></code>.
In that case, the Kalman filter will obtain the next internal state by stepping the state space model.</p>
<p>[1] Verhaegen, Michel, and Vincent Verdult. <em>Filtering and system identification: a least squares approach.</em>
Cambridge university press, 2007.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.extrapolate">
<span class="sig-name descname"><span class="pre">extrapolate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">timesteps</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.DataFrame</span></span></span><a class="reference internal" href="_modules/dynamapp/kalman.html#Kalman.extrapolate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamapp.kalman.Kalman.extrapolate" title="Link to this definition"></a></dt>
<dd><p>Make a <code class="docutils literal notranslate"><span class="pre">timesteps</span></code> number of steps ahead prediction about the output of the state-space model
<code class="docutils literal notranslate"><span class="pre">self.state_space</span></code> given no further inputs.
The result is a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code> where the columns are <code class="docutils literal notranslate"><span class="pre">self.state_space.y_column_names</span></code>:
the output columns of the state-space model <code class="docutils literal notranslate"><span class="pre">self.state_space</span></code>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.to_dataframe">
<span class="sig-name descname"><span class="pre">to_dataframe</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.DataFrame</span></span></span><a class="reference internal" href="_modules/dynamapp/kalman.html#Kalman.to_dataframe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamapp.kalman.Kalman.to_dataframe" title="Link to this definition"></a></dt>
<dd><p>Returns the output of the Kalman filter as a <code class="docutils literal notranslate"><span class="pre">pd.DataFrame</span></code>. The returned value contains information about
filtered and predicted states of the Kalman filter at different timesteps.
The expected standard deviation of the output is given, assuming independence (!) of the state estimation error
and measurement noise.</p>
<p>The rows of the returned dataframe correspond to timesteps.
The columns of the returned dataframe are a 3-dimensional multi-index with the following levels:</p>
<ol class="arabic simple">
<li><p>The output name, in the list <code class="docutils literal notranslate"><span class="pre">self.state_space.y_column_names</span></code>.</p></li>
<li><dl class="simple">
<dt>An indication of whether the value is</dt><dd><ul class="simple">
<li><p>a value that was actually measured, these values were given to <cite>self.step</cite> as the <cite>y</cite> parameter,</p></li>
<li><p>a filtered state,</p></li>
<li><p>a predicted state given no further input or</p></li>
<li><p>a predicted state where the effect of the next input has been corrected for.
This column is useful for comparing prediction performance.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Whether the column is a value or the corresponding expected standard deviation.</p></li>
</ol>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.plot_filtered">
<span class="sig-name descname"><span class="pre">plot_filtered</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">matplotlib.figure.Figure</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamapp/kalman.html#Kalman.plot_filtered"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamapp.kalman.Kalman.plot_filtered" title="Link to this definition"></a></dt>
<dd><p>The top graph plots the filtered output states of the Kalman filter and compares with the measured values.
The error bars correspond to the expected standard deviations.
The bottom graph zooms in on the errors between the filtered states and the measured values, compared with
the expected standard deviations.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dynamapp.kalman.Kalman.plot_predicted">
<span class="sig-name descname"><span class="pre">plot_predicted</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fig</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">matplotlib.figure.Figure</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps_to_extrapolate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dynamapp/kalman.html#Kalman.plot_predicted"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dynamapp.kalman.Kalman.plot_predicted" title="Link to this definition"></a></dt>
<dd><p>The top graph plots the predicted output states of the Kalman filter and compares with the measured values.
The error bars correspond to the expected standard deviations.</p>
<p>The stars on the top right represent the <code class="docutils literal notranslate"><span class="pre">steps_to_extrapolate</span></code>-steps ahead extrapolation under no further
inputs. The bottom graph zooms in on the errors between the predicted states and the measured values, compared
with the expected standard deviations.</p>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dynamapp.html" class="btn btn-neutral float-left" title="dynamapp" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dynamapp.math_utils.html" class="btn btn-neutral float-right" title="math_utils module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Wissem CHIHA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>